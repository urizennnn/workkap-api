datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum RegistrationMethod {
  COMBINATION
  GOOGLE
  FACEBOOK
  APPLE
}

enum OrderStatus {
  ACTIVE
  PENDING
  COMPLETED
  LATE
  CANCELLED
}

enum PackageTier {
  BASIC
  STANDARD
  PREMIUM
}

enum MediaType {
  IMAGE
  VIDEO
  DOCUMENT
}

model User {
  id                 String             @id @default(uuid())
  email              String?            @unique
  password           String?
  country            String?
  profilePictureUrl  String?
  username           String?            @unique
  fullName           String?
  registrationMethod RegistrationMethod @default(COMBINATION)
  createdAt          DateTime           @default(now())
  updatedAt          DateTime           @updatedAt
  Freelancer         Freelancer?
  Client             Client?

  @@map("users")
}

model Freelancer {
  id    String  @id @default(uuid())
  uid   String  @unique
  user  User    @relation(fields: [uid], references: [id])
  gigs  Gig[]
  Order Order[]

  @@map("freelancers")
}

model Client {
  id    String  @id @default(uuid())
  uid   String  @unique
  user  User    @relation(fields: [uid], references: [id])
  Order Order[]

  @@map("clients")
}

model Gig {
  id                  String         @id @default(uuid())
  slug                String         @unique @default(uuid())
  userId              String
  user                Freelancer     @relation(fields: [userId], references: [id])
  title               String
  mainCategory        String
  subCategory         String
  tools               String[]       @default([])
  tags                String[]       @default([])
  description         String         @db.VarChar(1000)
  packages            GigPackage[]
  extras              ExtraService[]
  questions           Question[]
  media               MediaItem[]
  thirdPartyAgreement Boolean        @default(false)
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt
  Order               Order[]

  @@map("gigs")
}

model GigPackage {
  id                String      @id @default(uuid())
  gig               Gig         @relation(fields: [gigId], references: [id])
  gigId             String
  tier              PackageTier
  name              String
  description       String
  deliveryTime      Int
  customAssetDesign Boolean     @default(false)
  sourceFile        Boolean     @default(false)
  contentUpload     Boolean     @default(false)
  convertToHtmlCss  Boolean     @default(false)
  revisions         Int         @default(0)
  price             Decimal     @db.Decimal(10, 2)
  totalPrice        Decimal     @db.Decimal(10, 2)
  Order             Order[]
}

model ExtraService {
  id           String  @id @default(uuid())
  gig          Gig     @relation(fields: [gigId], references: [id])
  gigId        String
  name         String
  deliveryTime Int
  price        Decimal @db.Decimal(10, 2)
}

model Question {
  id    String @id @default(uuid())
  gig   Gig    @relation(fields: [gigId], references: [id])
  gigId String
  text  String
}

model MediaItem {
  id    String    @id @default(uuid())
  gig   Gig       @relation(fields: [gigId], references: [id])
  gigId String
  type  MediaType
  url   String
}

model Order {
  id           String     @id @default(uuid())
  gigId        String
  gig          Gig        @relation(fields: [gigId], references: [id])
  clientId     String
  client       Client     @relation(fields: [clientId], references: [id])
  freelancerId String
  freelancer   Freelancer @relation(fields: [freelancerId], references: [id])
  packageId    String
  package      GigPackage @relation(fields: [packageId], references: [id])
  status       String     @default("ACTIVE") @map("order_status")
  totalPrice   Decimal    @db.Decimal(10, 2)
  amount       Int        @db.Integer()
  Note         String
  DueDate      DateTime
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt

  @@map("orders")
}
